SET default_storage_engine=InnoDB;
SET SESSION sql_mode = 'STRICT_ALL_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_ZERO_DATE,NO_ZERO_IN_DATE,NO_ENGINE_SUBSTITUTION';
SET @old_sql_notes=@@sql_notes, sql_notes=0;
CREATE TABLE t1 (a INT PRIMARY KEY, b VARCHAR(255) NOT NULL, c TIMESTAMP DEFAULT CURRENT_TIMESTAMP) ENGINE=InnoDB;
SHOW WARNINGS;
INSERT INTO t1 (a, b) VALUES (1, 'test1'), (2, 'test2');
SELECT * FROM t1;
UPDATE t1 SET b = 'updated' WHERE a = 1;
DELETE FROM t1 WHERE a = 2;
ALTER TABLE t1 ADD COLUMN d INT AFTER b;
INSERT INTO t1 (a, b, d) VALUES (3, 'test3', 123);
CREATE INDEX idx_b ON t1 (b);
EXPLAIN SELECT * FROM t1 WHERE b = 'test3';
RENAME TABLE t1 TO t2;
CREATE OR REPLACE VIEW v1 AS SELECT a, b FROM t2 WHERE d > 100;
SELECT * FROM v1;
DROP VIEW v1;
CREATE TABLE t3 (id INT AUTO_INCREMENT PRIMARY KEY, data JSON);
INSERT INTO t3 (data) VALUES ('{"name": "John", "age": 30}'), ('{"name": "Jane", "age": 25}');
SELECT data->'$.name' AS name FROM t3;
CREATE PROCEDURE p1 ()
BEGIN
    SELECT COUNT(*) FROM t2;
END;
CALL p1();
DROP PROCEDURE p1;
SET @old_sql_notes=@@sql_notes;
FLUSH TABLES t2;
ANALYZE TABLE t2;
OPTIMIZE TABLE t2;
CHECK TABLE t2;
SHOW CREATE TABLE t2;
SHOW TABLE STATUS LIKE 't2';