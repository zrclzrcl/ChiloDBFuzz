SET NAMES utf8;
CREATE TABLE test_table (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(255) NOT NULL,
  value INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO test_table (name, value) VALUES
('Alice', 10),
('Bob', 20),
('Charlie', 30);

CREATE INDEX idx_name ON test_table (name);

ALTER TABLE test_table ADD COLUMN description TEXT;

UPDATE test_table SET description = 'A basic entry' WHERE id = 1;

DELETE FROM test_table WHERE value < 15;

SELECT * FROM test_table ORDER BY value DESC LIMIT 2;

-- MariaDB Specific Feature: Window Functions
SELECT
  id,
  name,
  value,
  ROW_NUMBER() OVER (ORDER BY value DESC) AS row_num
FROM test_table;

-- MariaDB Specific Feature: JSON Functions
ALTER TABLE test_table ADD COLUMN json_data JSON;
UPDATE test_table SET json_data = JSON_OBJECT('key1', 'value1', 'key2', 123) WHERE id = 2;
SELECT id, JSON_EXTRACT(json_data, '$.key1') FROM test_table;

-- MariaDB Specific Feature: Dynamic Columns (example, might need modification based on MariaDB version)
CREATE TABLE dynamic_table (id INT PRIMARY KEY, attributes LONGBLOB);
INSERT INTO dynamic_table VALUES (1, COLUMN_CREATE('attr1', 10, 'attr2', 'value2'));
SELECT id, COLUMN_GET(attributes, 'attr1' AS CHAR) FROM dynamic_table;

OPTIMIZE TABLE test_table;
ANALYZE TABLE test_table;