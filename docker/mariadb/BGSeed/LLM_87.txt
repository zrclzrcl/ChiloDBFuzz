SET @old_sql_mode=@@sql_mode, sql_mode='STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION';
CREATE TABLE t1 (id INT PRIMARY KEY, a INT, b VARCHAR(20));
CREATE TABLE t2 (id INT PRIMARY KEY, c INT, d VARCHAR(20));
INSERT INTO t1 VALUES (1, 10, 'hello'), (2, 20, 'world'), (3, 30, 'test');
INSERT INTO t2 VALUES (1, 100, 'HELLO'), (2, 200, 'WORLD'), (4, 400, 'NEW');

-- Test different join types and conditions
SELECT * FROM t1 INNER JOIN t2 ON t1.id = t2.id;
SELECT * FROM t1 LEFT JOIN t2 ON t1.id = t2.id;
SELECT * FROM t1 RIGHT JOIN t2 ON t1.id = t2.id;
SELECT * FROM t1 LEFT JOIN t2 ON t1.id = t2.id WHERE t2.id IS NULL;
SELECT * FROM t1 RIGHT JOIN t2 ON t1.id = t2.id WHERE t1.id IS NULL;

-- Test subqueries and aggregation
SELECT a, COUNT(*) FROM t1 WHERE a > (SELECT AVG(c) FROM t2) GROUP BY a;
SELECT * FROM t1 WHERE id IN (SELECT id FROM t2 WHERE c > 150);

-- Test stored procedures (minimal example, requires procedure creation privileges)
-- CREATE PROCEDURE my_proc() SELECT * FROM t1;
-- CALL my_proc();
-- DROP PROCEDURE my_proc; -- Clean up

-- Test JSON functionality (MariaDB 10.2+)
ALTER TABLE t1 ADD COLUMN json_data JSON;
UPDATE t1 SET json_data = JSON_OBJECT('key1', a, 'key2', b) WHERE id = 1;
SELECT id, JSON_EXTRACT(json_data, '$.key1') FROM t1 WHERE id = 1;

-- Test window functions (MariaDB 10.3+)
SELECT a, ROW_NUMBER() OVER (ORDER BY a) AS row_num FROM t1;

-- Test GIS functions (basic example)
CREATE TABLE geom_test (id INT PRIMARY KEY, geom GEOMETRY);
INSERT INTO geom_test VALUES (1, ST_GeomFromText('POINT(1 1)'));
SELECT ST_AsText(geom) FROM geom_test;

-- Test dynamic columns
CREATE TABLE dynamic_col_test (id INT PRIMARY KEY, dyn_col MEDIUMBLOB);
INSERT INTO dynamic_col_test VALUES (1, COLUMN_CREATE('name', 'test', 'value', 123));
SELECT COLUMN_GET(dyn_col, 'name' AS CHAR) from dynamic_col_test;

SET sql_mode=@old_sql_mode;