CREATE TABLE employees (
    employee_id INT PRIMARY KEY AUTO_INCREMENT,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE,
    phone_number VARCHAR(20),
    hire_date DATE NOT NULL,
    job_id INT,
    salary DECIMAL(10, 2),
    commission_pct DECIMAL(4, 2),
    manager_id INT,
    department_id INT
);

CREATE TABLE departments (
    department_id INT PRIMARY KEY AUTO_INCREMENT,
    department_name VARCHAR(50) NOT NULL,
    manager_id INT,
    location_id INT
);

ALTER TABLE employees ADD FOREIGN KEY (department_id) REFERENCES departments(department_id);

INSERT INTO departments (department_name) VALUES ('Sales'), ('Marketing'), ('Engineering');

INSERT INTO employees (first_name, last_name, email, hire_date, salary, department_id) VALUES
('John', 'Doe', 'john.doe@example.com', '2023-01-15', 60000.00, 1),
('Jane', 'Smith', 'jane.smith@example.com', '2022-11-01', 75000.00, 2),
('Peter', 'Jones', 'peter.jones@example.com', '2023-03-10', 90000.00, 3);

-- Example of using JSON functions (MySQL specific)
ALTER TABLE employees ADD COLUMN additional_info JSON;
UPDATE employees SET additional_info = JSON_OBJECT('title', 'Sales Representative', 'experience', 3) WHERE first_name = 'John';

-- Example of using window functions
SELECT first_name, last_name, salary,
       RANK() OVER (ORDER BY salary DESC) as salary_rank
FROM employees;

-- Example of using stored procedures
DELIMITER //
CREATE PROCEDURE GetEmployeeCount(IN dept_id INT, OUT emp_count INT)
BEGIN
    SELECT COUNT(*) INTO emp_count FROM employees WHERE department_id = dept_id;
END //
DELIMITER ;

CALL GetEmployeeCount(1, @employee_count);
SELECT @employee_count;

-- Example of using Generated Invisible Primary Key (MySQL 8.0+) if supported
CREATE TABLE products (
    product_name VARCHAR(255)
) ENGINE=InnoDB;

INSERT INTO products (product_name) VALUES ('Widget A'), ('Widget B');

SELECT * FROM products;