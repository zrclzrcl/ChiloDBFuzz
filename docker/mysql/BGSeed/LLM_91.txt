SET GLOBAL validate_password.policy=LOW;
CREATE TABLE `products` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  `description` text,
  `price` decimal(10,2) NOT NULL,
  `category` enum('Electronics','Clothing','Home Goods') DEFAULT 'Electronics',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  FULLTEXT KEY `name_description` (`name`,`description`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO `products` (`name`, `description`, `price`, `category`) VALUES
('Wireless Mouse', 'Ergonomic wireless mouse for comfortable use.', 19.99, 'Electronics'),
('Cotton T-Shirt', 'Comfortable cotton t-shirt for everyday wear.', 12.50, 'Clothing'),
('Coffee Mug', 'Ceramic coffee mug with a modern design.', 8.00, 'Home Goods');

ALTER TABLE `products` ADD COLUMN `discount` DECIMAL(5,2) UNSIGNED NULL AFTER `price`;
UPDATE `products` SET `discount` = 5.00 WHERE `category` = 'Electronics';
CREATE TRIGGER `products_BEFORE_DELETE` BEFORE DELETE ON `products` FOR EACH ROW BEGIN
    INSERT INTO products_archive (id, name, description, price, category, created_at, deleted_at)
    VALUES (OLD.id, OLD.name, OLD.description, OLD.price, OLD.category, OLD.created_at, NOW());
END;

CREATE TABLE `products_archive` (
  `id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `description` text,
  `price` decimal(10,2) NOT NULL,
  `category` enum('Electronics','Clothing','Home Goods') DEFAULT 'Electronics',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `deleted_at` timestamp NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE PROCEDURE `update_product_price` (IN product_id INT, IN new_price DECIMAL(10,2))
BEGIN
    UPDATE products SET price = new_price WHERE id = product_id;
END;

CALL update_product_price(1, 22.50);