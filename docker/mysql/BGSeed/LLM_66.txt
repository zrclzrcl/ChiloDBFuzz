SET @old_sql_mode=@@sql_mode;
SET sql_mode = 'STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- Test edge cases with data types and boundary values
CREATE TABLE test_types (
    id INT PRIMARY KEY AUTO_INCREMENT,
    tiny_int TINYINT,
    small_int SMALLINT,
    medium_int MEDIUMINT,
    normal_int INT,
    big_int BIGINT,
    float_val FLOAT,
    double_val DOUBLE,
    decimal_val DECIMAL(10,2),
    date_val DATE,
    datetime_val DATETIME,
    timestamp_val TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    char_val CHAR(10),
    varchar_val VARCHAR(255),
    text_val TEXT,
    blob_val BLOB,
    enum_val ENUM('value1', 'value2', 'value3'),
    set_val SET('option1', 'option2', 'option3')
);

INSERT INTO test_types (tiny_int, small_int, medium_int, normal_int, big_int, float_val, double_val, decimal_val, date_val, datetime_val, char_val, varchar_val, text_val, blob_val, enum_val, set_val) VALUES
(-128, -32768, -8388608, -2147483648, -9223372036854775808, 3.4E+38, 1.7E+308, 99999999.99, '0000-01-01', '0000-01-01 00:00:00', 'char1', 'varchar1', 'text1', 'blob1', 'value1', 'option1,option2'),
(127, 32767, 8388607, 2147483647, 9223372036854775807, -3.4E+38, -1.7E+308, -99999999.99, '9999-12-31', '9999-12-31 23:59:59', 'char2', 'varchar2', 'text2', 'blob2', 'value2', 'option2,option3'),
(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);

-- Test partitioning (MySQL specific)
CREATE TABLE sales (
    sale_id INT,
    sale_date DATE,
    amount DECIMAL(10, 2)
)
PARTITION BY RANGE ( YEAR(sale_date) ) (
    PARTITION p0 VALUES LESS THAN (2020),
    PARTITION p1 VALUES LESS THAN (2021),
    PARTITION p2 VALUES LESS THAN (2022),
    PARTITION p3 VALUES LESS THAN MAXVALUE
);

INSERT INTO sales (sale_id, sale_date, amount) VALUES
(1, '2019-01-01', 100.00),
(2, '2020-02-15', 200.00),
(3, '2021-03-20', 300.00),
(4, '2022-04-25', 400.00);

-- Test stored procedures
DELIMITER //
CREATE PROCEDURE GetSalesByYear(IN year_val INT)
BEGIN
    SELECT * FROM sales WHERE YEAR(sale_date) = year_val;
END //
DELIMITER ;

CALL GetSalesByYear(2020);

-- Test views
CREATE VIEW high_sales AS
SELECT sale_id, sale_date, amount FROM sales WHERE amount > 250;

SELECT * FROM high_sales;

-- Test indexes
CREATE INDEX idx_sale_date ON sales (sale_date);

-- Test temporary tables
CREATE TEMPORARY TABLE temp_sales AS SELECT * FROM sales WHERE amount > 150;

SELECT * FROM temp_sales;

-- Test fulltext index
CREATE TABLE articles (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255),
    body TEXT,
    FULLTEXT (title,body)
);

INSERT INTO articles (title, body) VALUES
('MySQL Tutorial', 'Learn MySQL quickly and easily.'),
('Advanced MySQL', 'Explore advanced features of MySQL.');

SELECT * FROM articles WHERE MATCH (title, body) AGAINST ('MySQL');

-- Test JSON functions (MySQL 5.7+)
CREATE TABLE json_data (
  id INT PRIMARY KEY AUTO_INCREMENT,
  data JSON
);

INSERT INTO json_data (data) VALUES
('{"name": "John", "age": 30, "city": "New York"}'),
('{"name": "Jane", "age": 25, "city": "London"}');

SELECT data->'$.name' AS name FROM json_data;

-- Test spatial data types (requires spatial extensions)
CREATE TABLE places (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(255),
  location POINT SRID 0
);

INSERT INTO places (name, location) VALUES
('Point A', ST_GeomFromText('POINT(10 10)')),
('Point B', ST_GeomFromText('POINT(20 20)'));

SELECT ST_AsText(location) FROM places;

SET sql_mode = @old_sql_mode;