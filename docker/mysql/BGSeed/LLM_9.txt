CREATE TABLE products (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    price DECIMAL(10, 2) NOT NULL,
    category VARCHAR(50)
);

INSERT INTO products (name, description, price, category) VALUES
('Laptop', 'High-performance laptop', 1200.00, 'Electronics'),
('Mouse', 'Wireless mouse', 25.00, 'Electronics'),
('T-shirt', 'Cotton T-shirt', 15.00, 'Clothing');

CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    customer_id INT,
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    total_amount DECIMAL(10, 2) NOT NULL
);

CREATE TABLE customers (
    id INT PRIMARY KEY AUTO_INCREMENT,
    first_name VARCHAR(255) NOT NULL,
    last_name VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE,
    phone_number VARCHAR(20)
);

INSERT INTO customers (first_name, last_name, email, phone_number) VALUES
('John', 'Doe', 'john.doe@example.com', '123-456-7890'),
('Jane', 'Smith', 'jane.smith@example.com', '987-654-3210');

INSERT INTO orders (customer_id, total_amount) VALUES
(1, 1225.00),
(2, 15.00);

SELECT p.name, o.order_date FROM products p JOIN orders o ON p.id = o.customer_id WHERE p.price > 1000;

-- MySQL specific function example:  Calculate the CRC32 checksum of the product name. This is MySQL specific.
SELECT name, CRC32(name) FROM products;

-- Try a spatial data type.
CREATE TABLE places (id INT PRIMARY KEY AUTO_INCREMENT, name VARCHAR(255), location POINT);
INSERT INTO places (name, location) VALUES ('My House', ST_GeomFromText('POINT(10 10)'));
SELECT name, ST_AsText(location) FROM places;

-- Test JSON column functionality. Requires MySQL 5.7+ or MariaDB 10.2+
ALTER TABLE products ADD COLUMN details JSON;
UPDATE products SET details = '{"color": "silver", "weight": 2.5}' WHERE name = 'Laptop';
SELECT name, details->'$.color' AS color FROM products WHERE name = 'Laptop';

-- Try a stored procedure with a simple output parameter
DELIMITER //
CREATE PROCEDURE GetProductCount(OUT total INT)
BEGIN
    SELECT COUNT(*) INTO total FROM products;
END //
DELIMITER ;

CALL GetProductCount(@product_count);
SELECT @product_count;