SET @old_sql_mode=@@sql_mode, sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';
SET @auto_increment_increment=3;
SET @auto_increment_offset=1;

CREATE TABLE products (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2) NULL,
    category ENUM('Electronics', 'Clothing', 'Books') DEFAULT 'Books',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

INSERT INTO products (name, price, category) VALUES
('Laptop', 1200.00, 'Electronics'),
('T-shirt', 25.00, 'Clothing'),
('Database Design', 40.00, 'Books');

CREATE TABLE orders (
    order_id INT AUTO_INCREMENT PRIMARY KEY,
    product_id INT NOT NULL,
    quantity INT NOT NULL,
    order_date DATE NOT NULL,
    FOREIGN KEY (product_id) REFERENCES products(id)
);

INSERT INTO orders (product_id, quantity, order_date) VALUES
(1, 1, '2023-10-26'),
(2, 3, '2023-10-27'),
(3, 2, '2023-10-28');

-- Test case for JSON functions
SELECT JSON_OBJECT('id', id, 'name', name) AS product_json FROM products WHERE id = 1;

-- Test case for window functions
SELECT
    name,
    price,
    AVG(price) OVER () AS average_price
FROM
    products;

-- Test case for spatial data (requires spatial extensions to be enabled) - Remove if not available by default.
CREATE TABLE spatial_test (id INT PRIMARY KEY, g GEOMETRY);
INSERT INTO spatial_test VALUES (1, ST_GeomFromText('POINT(1 1)'));
SELECT ST_AsText(g) FROM spatial_test;

SET sql_mode=@old_sql_mode;