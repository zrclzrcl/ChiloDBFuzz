CREATE TABLE integers (i INTEGER);
INSERT INTO integers VALUES (1), (2), (3), (4), (5);

CREATE TABLE strings (s VARCHAR);
INSERT INTO strings VALUES ('a'), ('b'), ('c'), ('d'), ('e');

-- Demonstrating window functions
SELECT i, ROW_NUMBER() OVER (ORDER BY i) FROM integers;

-- Demonstrating string manipulation
SELECT s, UPPER(s) FROM strings;

-- Demonstrating date functions
CREATE TABLE dates (d DATE);
INSERT INTO dates VALUES ('2023-01-01'), ('2023-02-15'), ('2023-03-31');
SELECT d, DATE_TRUNC('month', d) FROM dates;

-- Demonstrating aggregate functions
SELECT AVG(i) FROM integers;

-- Demonstrating list functions (DuckDB specific)
SELECT list(i) FROM integers;

-- Demonstrating unnesting (DuckDB specific)
SELECT * FROM UNNEST([1, 2, 3]);

-- Demonstrating JSON functions (DuckDB specific)
SELECT JSON('{"a": 1, "b": 2}');

-- Demonstrating grouping sets
SELECT i, COUNT(*) FROM integers GROUP BY GROUPING SETS ((i), ());

-- Demonstrate try_cast
SELECT TRY_CAST('hello' AS INTEGER);