CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    name VARCHAR,
    price DECIMAL(10, 2),
    category VARCHAR
);

INSERT INTO products (name, price, category) VALUES ('Laptop', 1200.50, 'Electronics');
INSERT INTO products (name, price, category) VALUES ('Keyboard', 75.00, 'Electronics');
INSERT INTO products (name, price, category) VALUES ('T-shirt', 20.00, 'Clothing');

CREATE VIEW expensive_products AS
SELECT name, price FROM products WHERE price > 100;

CREATE TABLE orders (
    order_id INTEGER PRIMARY KEY,
    customer_id INTEGER,
    product_id INTEGER,
    quantity INTEGER,
    order_date DATE
);

INSERT INTO orders (customer_id, product_id, quantity, order_date) VALUES (1, 1, 1, '2023-01-15');
INSERT INTO orders (customer_id, product_id, quantity, order_date) VALUES (2, 2, 2, '2023-02-20');
INSERT INTO orders (customer_id, product_id, quantity, order_date) VALUES (1, 3, 3, '2023-03-10');

-- DuckDB specific feature: APPROXIMATE COUNT DISTINCT
SELECT APPROX_COUNT_DISTINCT(customer_id) FROM orders;

-- DuckDB specific feature: INSTALL & LOAD extensions (example using httpfs to read from HTTP)
INSTALL httpfs;
LOAD httpfs;

--Example using httpfs (replace with a valid URL)
--SELECT * FROM read_csv_auto('https://example.com/data.csv');

CREATE SEQUENCE my_sequence START 1 INCREMENT 1;

SELECT nextval('my_sequence');
SELECT currval('my_sequence');

--DuckDB support for JSON
CREATE TABLE json_data (data JSON);
INSERT INTO json_data VALUES ('{"name": "John", "age": 30}');

SELECT data -> 'name' FROM json_data;