CREATE TABLE IF NOT EXISTS products (
    product_id INTEGER PRIMARY KEY,
    product_name VARCHAR(255),
    price DECIMAL(10, 2),
    category VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS customers (
    customer_id INTEGER PRIMARY KEY,
    customer_name VARCHAR(255),
    city VARCHAR(100)
);

INSERT INTO products (product_name, price, category) VALUES
    ('Laptop', 1200.00, 'Electronics'),
    ('Smartphone', 800.00, 'Electronics'),
    ('T-Shirt', 25.00, 'Clothing'),
    ('Coffee Maker', 50.00, 'Appliances');

INSERT INTO customers (customer_name, city) VALUES
    ('Alice', 'New York'),
    ('Bob', 'Los Angeles'),
    ('Charlie', 'Chicago');

-- Demonstrate window function with PARTITION BY and ORDER BY (DuckDB supports this well)
SELECT
    product_name,
    price,
    category,
    RANK() OVER (PARTITION BY category ORDER BY price DESC) as price_rank
FROM products;

-- Demonstrate LIST aggregation, a DuckDB specific feature
SELECT category, LIST(product_name) FROM products GROUP BY category;

-- Demonstrate UNNEST (another potential fuzzing area)
SELECT * FROM UNNEST([1, 2, 3]);

-- Demonstrate string functions (a good area for fuzzing)
SELECT product_name, UPPER(product_name), LENGTH(product_name) FROM products;

-- Demonstrate date function. DuckDB supports date operation.
CREATE TABLE IF NOT EXISTS orders (order_id INTEGER PRIMARY KEY, order_date DATE);
INSERT INTO orders (order_date) VALUES ('2024-01-01');
SELECT order_date, DATE_TRUNC('month', order_date) FROM orders;