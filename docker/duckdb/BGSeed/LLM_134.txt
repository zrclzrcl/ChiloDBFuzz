CREATE TABLE integers (
  i INTEGER
);

INSERT INTO integers VALUES (1), (2), (3), (4), (5);

CREATE TABLE strings (
  s VARCHAR
);

INSERT INTO strings VALUES ('a'), ('b'), ('c'), ('d'), ('e');

-- Attempt to trigger type confusion/coercion edge cases
SELECT i + s FROM integers, strings LIMIT 1;

-- Test string functions unique to DuckDB (or less common)
SELECT string_split(s, 'a') FROM strings WHERE s LIKE '%a%';

-- Test LIST functionality (DuckDB specific)
CREATE TABLE lists (
  l INTEGER[]
);

INSERT INTO lists VALUES (LIST(1, 2, 3)), (LIST(4, 5, 6));

SELECT list_sum(l) FROM lists;

--Test STRUCT functionality (DuckDB specific)
CREATE TABLE structs AS SELECT STRUCT(key := i, value := s) AS my_struct FROM integers, strings LIMIT 2;
SELECT my_struct.key, my_struct.value FROM structs;