CREATE TABLE orders (
    order_id INTEGER PRIMARY KEY,
    customer_id INTEGER,
    order_date DATE,
    total_amount DECIMAL(10, 2)
);

CREATE TABLE customers (
    customer_id INTEGER PRIMARY KEY,
    customer_name VARCHAR,
    city VARCHAR
);

-- Insert some sample data
INSERT INTO customers (customer_id, customer_name, city) VALUES
(1, 'Alice', 'New York'),
(2, 'Bob', 'Los Angeles'),
(3, 'Charlie', 'Chicago');

INSERT INTO orders (order_id, customer_id, order_date, total_amount) VALUES
(101, 1, '2023-01-15', 150.00),
(102, 2, '2023-02-20', 200.50),
(103, 1, '2023-03-10', 75.25);

-- Try an update with a type mismatch (should error)
UPDATE orders SET order_date = 123 WHERE order_id = 101;

-- Test DuckDB-specific feature: APPROX_COUNT_DISTINCT
SELECT APPROX_COUNT_DISTINCT(customer_id) FROM orders;

-- Test a correlated subquery within a WHERE clause
SELECT customer_name FROM customers WHERE customer_id IN (SELECT customer_id FROM orders WHERE total_amount > (SELECT AVG(total_amount) FROM orders));