CREATE TABLE orders (
    order_id INTEGER PRIMARY KEY,
    customer_id INTEGER,
    order_date DATE,
    total_amount DECIMAL(10, 2)
);

CREATE TABLE customers (
    customer_id INTEGER PRIMARY KEY,
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    email VARCHAR(255),
    city VARCHAR(255)
);

INSERT INTO customers (customer_id, first_name, last_name, email, city) VALUES
(1, 'Alice', 'Smith', 'alice.smith@example.com', 'New York'),
(2, 'Bob', 'Johnson', 'bob.johnson@example.com', 'Los Angeles'),
(3, 'Charlie', 'Brown', 'charlie.brown@example.com', 'Chicago');

INSERT INTO orders (order_id, customer_id, order_date, total_amount) VALUES
(101, 1, '2023-01-15', 120.50),
(102, 2, '2023-02-20', 75.00),
(103, 1, '2023-03-10', 200.00),
(104, 3, '2023-04-05', 50.00);

-- Demonstrating window functions
SELECT
    order_id,
    customer_id,
    order_date,
    total_amount,
    ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY order_date) AS order_number
FROM
    orders;

-- Using UNNEST with a list to demonstrate DuckDB's list functionality
SELECT i FROM UNNEST([1, 2, 3, 4, 5]) AS t(i);

-- Demonstrating LIST aggregation and LIST_VALUE
SELECT customer_id, LIST(order_id) FROM orders GROUP BY customer_id;

-- Demonstrating STRUCT creation and access
SELECT STRUCT_PACK(a := 1, b := 'hello');
SELECT (STRUCT_PACK(a := 1, b := 'hello')).a;

-- Demonstrate DuckDB's support for JSON
SELECT JSON('{ "a": 1, "b": "hello" }');

-- Demonstrate HASH function
SELECT HASH('DuckDB');

-- Test date functions
SELECT DATE('2024-01-01') + INTERVAL '1 day';

-- Create a table using a CTAS statement, and insert data
CREATE TABLE small_ints AS SELECT * FROM (VALUES (CAST(1 AS SMALLINT)), (CAST(2 AS SMALLINT)), (CAST(3 AS SMALLINT))) AS t(i);

INSERT INTO small_ints VALUES (4), (5);

SELECT * FROM small_ints;