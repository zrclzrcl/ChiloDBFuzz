CREATE TABLE test_table (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50),
    value INTEGER,
    description TEXT
);

INSERT INTO test_table (name, value, description) VALUES
('Alice', 10, 'Description for Alice'),
('Bob', 20, 'Description for Bob'),
('Charlie', 30, 'Description for Charlie'),
('David', 40, 'Description for David');

CREATE INDEX idx_name ON test_table (name);

SELECT * FROM test_table WHERE value > 20;

UPDATE test_table SET value = 50 WHERE name = 'Alice';

DELETE FROM test_table WHERE id = 4;

SELECT COUNT(*) FROM test_table;

SELECT AVG(value) FROM test_table;

SELECT name, SUM(value) FROM test_table GROUP BY name;

SELECT description, LENGTH(description) FROM test_table;

SELECT name FROM test_table WHERE description LIKE '%Bob%';

SELECT UPPER(name), LOWER(description) FROM test_table;

CREATE VIEW test_view AS SELECT id, name, value FROM test_table WHERE value > 15;

SELECT * FROM test_view;

ALTER TABLE test_table ADD COLUMN created_at TIMESTAMP DEFAULT NOW();

SELECT * FROM test_table ORDER BY value DESC;

SELECT DISTINCT name FROM test_table;

SELECT id, name, value FROM test_table LIMIT 2 OFFSET 1;

SELECT * FROM test_table WHERE value BETWEEN 15 AND 35;

SELECT * FROM test_table WHERE name IN ('Alice', 'Charlie');

SELECT * FROM test_table WHERE description IS NOT NULL;

SELECT coalesce(name, 'Unknown') FROM test_table;

SELECT name, value,
       CASE
           WHEN value > 30 THEN 'High'
           WHEN value > 15 THEN 'Medium'
           ELSE 'Low'
       END AS value_level
FROM test_table;

CREATE TEMPORARY TABLE temp_table AS SELECT * FROM test_table WHERE value > 25;

SELECT * FROM temp_table;

DROP TABLE IF EXISTS temp_table;

CREATE TABLE parent_table (
    id SERIAL PRIMARY KEY,
    parent_name VARCHAR(50)
);

CREATE TABLE child_table (
    id SERIAL PRIMARY KEY,
    parent_id INTEGER REFERENCES parent_table(id),
    child_name VARCHAR(50)
);

INSERT INTO parent_table (parent_name) VALUES ('Parent 1'), ('Parent 2');
INSERT INTO child_table (parent_id, child_name) VALUES (1, 'Child 1'), (1, 'Child 2'), (2, 'Child 3');

SELECT parent_table.parent_name, child_table.child_name
FROM parent_table
INNER JOIN child_table ON parent_table.id = child_table.parent_id;

CREATE FUNCTION increment(i INTEGER) RETURNS INTEGER AS $$
        BEGIN
                RETURN i + 1;
        END;
$$ LANGUAGE plpgsql;

SELECT increment(5);

CREATE OR REPLACE PROCEDURE transfer_funds(sender INT, receiver INT, amount DECIMAL)
LANGUAGE plpgsql
AS $$
BEGIN
    UPDATE test_table SET value = value - amount WHERE id = sender;
    UPDATE test_table SET value = value + amount WHERE id = receiver;
    COMMIT;
END;
$$;

CALL transfer_funds(1, 2, 5.00);

SELECT * FROM test_table;

DROP TABLE IF EXISTS test_table CASCADE;
DROP TABLE IF EXISTS parent_table CASCADE;
DROP TABLE IF EXISTS child_table CASCADE;
DROP FUNCTION IF EXISTS increment(INTEGER);
DROP PROCEDURE IF EXISTS transfer_funds(INT, INT, DECIMAL);
DROP VIEW IF EXISTS test_view;