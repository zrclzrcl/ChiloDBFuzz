CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    product_name VARCHAR(255) NOT NULL,
    price DECIMAL(10, 2)
);

INSERT INTO products (product_name, price) VALUES ('Laptop', 1200.00);
INSERT INTO products (product_name, price) VALUES ('Keyboard', 75.50);
INSERT INTO products (product_name, price) VALUES ('Mouse', 25.00);

CREATE INDEX idx_product_name ON products (product_name);

SELECT * FROM products WHERE price > 50;

UPDATE products SET price = price * 1.1 WHERE product_name = 'Laptop';

DELETE FROM products WHERE product_id = 3;

SELECT COUNT(*) FROM products;

SELECT AVG(price) FROM products;

SELECT MAX(price) FROM products;

SELECT MIN(price) FROM products;

SELECT SUM(price) FROM products;

SELECT product_name, price FROM products ORDER BY price DESC;

SELECT product_name, price FROM products ORDER BY price ASC LIMIT 2;

SELECT product_name FROM products WHERE product_name LIKE 'K%';

SELECT product_name FROM products WHERE product_name ILIKE 'k%';

SELECT product_name, price FROM products WHERE price BETWEEN 50 AND 1500;

SELECT product_name, price FROM products WHERE product_id IN (1, 2);

SELECT product_name, price FROM products WHERE product_id NOT IN (1, 2);

SELECT product_name, price FROM products WHERE product_name IS NOT NULL;

SELECT product_name, price FROM products WHERE product_name IS NULL;

SELECT EXISTS (SELECT 1 FROM products WHERE price > 1000);

SELECT product_name, COALESCE(CAST(price AS VARCHAR), 'N/A') FROM products;

SELECT product_name, NULLIF(CAST(price AS TEXT), '1200.00') FROM products;

SELECT product_name, CASE WHEN price > 100 THEN 'Expensive' ELSE 'Cheap' END FROM products;

SELECT product_name, CAST(price AS INTEGER) FROM products;

SELECT product_name, price::TEXT FROM products;

SELECT product_name, LENGTH(product_name) FROM products;

SELECT product_name, UPPER(product_name) FROM products;

SELECT product_name, LOWER(product_name) FROM products;

SELECT product_name, SUBSTRING(product_name, 1, 3) FROM products;

SELECT product_name, POSITION('top' IN product_name) FROM products;

SELECT product_name, REPLACE(product_name, 'Keyboard', 'Keypad') FROM products;

SELECT product_name, TRIM(product_name) FROM products;

SELECT product_name, product_name || ' - Price: ' || CAST(price AS TEXT) FROM products;

SELECT md5(product_name) FROM products;

SELECT product_name, price FROM products GROUP BY product_name, price;

SELECT product_name, COUNT(*) FROM products GROUP BY product_name;

SELECT product_name, AVG(price) FROM products GROUP BY product_name HAVING AVG(price) > 50;

CREATE VIEW cheap_products AS SELECT product_name, price FROM products WHERE price < 100;

SELECT * FROM cheap_products;

DROP VIEW cheap_products;

ALTER TABLE products ADD COLUMN description TEXT;

UPDATE products SET description = 'High performance laptop' WHERE product_name = 'Laptop';

ALTER TABLE products ALTER COLUMN price TYPE NUMERIC(12, 2);

ALTER TABLE products RENAME COLUMN product_name TO item_name;

ALTER TABLE products RENAME TO items;

DROP TABLE items;

CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    product_id INT REFERENCES products(product_id),
    quantity INT
);

INSERT INTO orders (product_id, quantity) VALUES (1, 2);

SELECT * FROM orders INNER JOIN products ON orders.product_id = products.product_id;

SELECT * FROM orders LEFT JOIN products ON orders.product_id = products.product_id;

SELECT * FROM orders RIGHT JOIN products ON orders.product_id = products.product_id;

SELECT * FROM orders FULL OUTER JOIN products ON orders.product_id = products.product_id;

SELECT * FROM products UNION SELECT * FROM products;
SELECT * FROM products UNION ALL SELECT * FROM products;
SELECT * FROM products INTERSECT SELECT * FROM products;
SELECT * FROM products EXCEPT SELECT * FROM products;

CREATE FUNCTION add_tax(price DECIMAL(10, 2), tax_rate DECIMAL(5, 2)) RETURNS DECIMAL(10, 2) AS $$
BEGIN
    RETURN price + (price * tax_rate);
END;
$$ LANGUAGE plpgsql;

SELECT add_tax(100, 0.1);

DROP FUNCTION add_tax(DECIMAL, DECIMAL);

CREATE TABLE employees (id SERIAL PRIMARY KEY, name VARCHAR(50), salary DECIMAL(10, 2));
INSERT INTO employees (name, salary) VALUES ('Alice', 60000);
INSERT INTO employees (name, salary) VALUES ('Bob', 75000);

CREATE OR REPLACE PROCEDURE transfer_funds(sender_id INT, receiver_id INT, amount DECIMAL(10, 2))
LANGUAGE plpgsql
AS $$
BEGIN
    UPDATE employees SET salary = salary - amount WHERE id = sender_id;
    UPDATE employees SET salary = salary + amount WHERE id = receiver_id;
    COMMIT;
END;
$$;

CALL transfer_funds(1, 2, 5000);
SELECT * FROM employees;
DROP PROCEDURE transfer_funds(INT, INT, DECIMAL);
DROP TABLE employees;

CREATE TABLE test_range (id INT, r INT4RANGE);
INSERT INTO test_range (id, r) VALUES (1, '[10,20]');
SELECT * FROM test_range WHERE r && int4range(15, 25);
SELECT * FROM test_range WHERE r @> 15;
DROP TABLE test_range;

CREATE TABLE test_tsvector (id SERIAL PRIMARY KEY, body TEXT);
INSERT INTO test_tsvector (body) VALUES ('The quick brown fox jumps over the lazy dog.');
SELECT to_tsvector('english', body) FROM test_tsvector;
DROP TABLE test_tsvector;

CREATE TABLE test_json (id SERIAL PRIMARY KEY, data JSONB);
INSERT INTO test_json (data) VALUES ('{"name": "John Doe", "age": 30}');
SELECT data ->> 'name' FROM test_json;
SELECT data #>> '{name}' FROM test_json;
DROP TABLE test_json;