DROP TABLE IF EXISTS employees;
DROP TABLE IF EXISTS departments;
DROP TABLE IF EXISTS products;
DROP TABLE IF EXISTS sales;
DROP TABLE IF EXISTS json_test;
DROP COLLATION IF EXISTS german;

CREATE COLLATION german (provider = icu, locale = 'de-DE');

CREATE TABLE departments (
    dept_id SERIAL PRIMARY KEY,
    dept_name VARCHAR(50) UNIQUE
);

CREATE TABLE employees (
    emp_id SERIAL PRIMARY KEY,
    emp_name VARCHAR(100),
    salary DECIMAL(10, 2),
    dept_id INTEGER REFERENCES departments(dept_id),
    hire_date DATE
);

CREATE TABLE products (
    prod_id SERIAL PRIMARY KEY,
    prod_name VARCHAR(100),
    price DECIMAL(10, 2)
);

CREATE TABLE sales (
    sale_id SERIAL PRIMARY KEY,
    emp_id INTEGER REFERENCES employees(emp_id),
    prod_id INTEGER REFERENCES products(prod_id),
    sale_date DATE,
    quantity INTEGER
);

CREATE TABLE json_test (
    id SERIAL PRIMARY KEY,
    data JSONB
);

INSERT INTO departments (dept_name) VALUES
('Sales'),
('Marketing'),
('Engineering');

INSERT INTO employees (emp_name, salary, dept_id, hire_date) VALUES
('Alice Smith', 60000.00, 1, '2022-01-15'),
('Bob Johnson', 75000.00, 2, '2021-05-20'),
('Charlie Brown', 90000.00, 3, '2020-11-01');

INSERT INTO products (prod_name, price) VALUES
('Widget A', 25.00),
('Widget B', 50.00),
('Widget C', 75.00);

INSERT INTO sales (emp_id, prod_id, sale_date, quantity) VALUES
(1, 1, '2023-01-01', 10),
(2, 2, '2023-01-05', 5),
(3, 3, '2023-01-10', 2);

INSERT INTO json_test (data) VALUES
('{"name": "John Doe", "age": 30, "city": "New York"}'),
('{"name": "Jane Doe", "age": 25, "city": "Los Angeles"}');

SELECT * FROM departments;
SELECT * FROM employees WHERE salary > 70000;
SELECT emp_name, salary FROM employees ORDER BY salary DESC;
SELECT COUNT(*) FROM sales;
SELECT AVG(salary) FROM employees;
SELECT dept_name, COUNT(*) FROM employees JOIN departments ON employees.dept_id = departments.dept_id GROUP BY dept_name;
UPDATE employees SET salary = salary * 1.1 WHERE dept_id = 3;
DELETE FROM sales WHERE sale_date < '2023-01-05';
SELECT * FROM sales WHERE sale_date BETWEEN '2023-01-01' AND '2023-01-10';
SELECT * FROM employees WHERE emp_name LIKE 'A%';
SELECT * FROM employees WHERE emp_name ILIKE 'a%';
SELECT * FROM products WHERE prod_name SIMILAR TO '%(A|B)%';
SELECT * FROM products WHERE prod_name ~ '^[A-Z].*';
SELECT * FROM employees ORDER BY emp_name COLLATE "german";
SELECT data ->> 'name' FROM json_test;
SELECT * FROM json_test WHERE (data ->> 'age')::integer > 27;
SELECT generate_series(1, 10);
EXPLAIN SELECT * FROM employees WHERE salary > 70000;
VACUUM FULL employees;
CREATE VIEW high_earners AS SELECT emp_name, salary FROM employees WHERE salary > 80000;
SELECT * FROM high_earners;
SELECT  e.emp_name, d.dept_name FROM employees e INNER JOIN departments d ON e.dept_id = d.dept_id WHERE e.salary > 50000;
SELECT  e.emp_name, d.dept_name FROM employees e LEFT JOIN departments d ON e.dept_id = d.dept_id WHERE e.salary > 50000;
SELECT  e.emp_name, d.dept_name FROM employees e RIGHT JOIN departments d ON e.dept_id = d.dept_id WHERE e.salary > 50000;
SELECT  e.emp_name, d.dept_name FROM employees e FULL OUTER JOIN departments d ON e.dept_id = d.dept_id WHERE e.salary > 50000;