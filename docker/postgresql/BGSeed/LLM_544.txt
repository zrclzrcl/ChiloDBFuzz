CREATE TABLE test_table (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50),
    value INTEGER
);

INSERT INTO test_table (name, value) VALUES
('Alice', 10),
('Bob', 20),
('Charlie', 30);

SELECT * FROM test_table WHERE value > 15;

UPDATE test_table SET value = value + 5 WHERE name = 'Bob';

DELETE FROM test_table WHERE id = 1;

SELECT COUNT(*) FROM test_table;

SELECT AVG(value) FROM test_table;

SELECT MAX(value), MIN(value) FROM test_table;

SELECT name, SUM(value) FROM test_table GROUP BY name;

SELECT name, value FROM test_table ORDER BY value DESC;

CREATE INDEX value_index ON test_table (value);

EXPLAIN SELECT * FROM test_table WHERE value > 25;

SELECT version();

SELECT current_database();

SELECT current_user;

SELECT inet_client_addr();

SELECT inet_server_addr();

SELECT pg_backend_pid();

SELECT pg_database_size('postgres');

SELECT pg_cancel_backend(pg_backend_pid());

CREATE TEMPORARY TABLE temp_table (
    id INTEGER,
    data TEXT
);

INSERT INTO temp_table VALUES (1, 'test');

SELECT * FROM temp_table;

DROP TABLE temp_table;

CREATE VIEW test_view AS
SELECT name, value FROM test_table WHERE value > 20;

SELECT * FROM test_view;

DROP VIEW test_view;

SELECT generate_series(1, 5);

SELECT generate_series(1, 10, 2);

SELECT to_char(current_timestamp, 'YYYY-MM-DD HH24:MI:SS');

SELECT md5('test_string');

SELECT encode('test_string', 'base64');

SELECT decode('dGVzdF9zdHJpbmc=', 'base64');

SELECT substring('test_string' from 1 for 4);

SELECT replace('test_string', 'test', 'new_test');

SELECT upper('test_string');

SELECT lower('TEST_STRING');

SELECT length('test_string');

SELECT current_date;

SELECT current_time;

SELECT now();

SELECT age(timestamp '2023-01-01', current_timestamp);

SELECT extract(YEAR FROM current_timestamp);

SELECT to_tsvector('english', 'A fat cat sat on a mat');

SELECT to_tsquery('english', 'fat & cat');

SELECT 'A fat cat sat on a mat'::tsvector @@ 'cat'::tsquery;

SELECT json_build_object('name', 'John', 'age', 30);

SELECT '{"name": "John", "age": 30}'::json -> 'name';

SELECT json_array_elements('[1, 2, 3]');

SELECT uuid_generate_v4();

SELECT coalesce(NULL, 'default_value');

SELECT NULLIF('value', 'value');

SELECT greatest(1, 5, 2, 8);

SELECT least(1, 5, 2, 8);

SELECT random();

SELECT setseed(0.5);

SELECT trunc(42.8);

SELECT round(42.8);

SELECT floor(42.8);

SELECT ceil(42.8);

SELECT sqrt(16);

SELECT power(2, 3);

SELECT sin(0);

SELECT cos(0);

SELECT tan(0);

SELECT array[1, 2, 3];

SELECT array_append(array[1, 2], 3);

SELECT array_prepend(1, array[2, 3]);

SELECT array_length(array[1, 2, 3], 1);

SELECT unnest(array[1, 2, 3]);

CREATE TYPE mood AS ENUM ('sad', 'ok', 'happy');

CREATE TABLE person (
    name TEXT,
    current_mood mood
);

INSERT INTO person VALUES ('Pete', 'happy');

SELECT * FROM person WHERE current_mood = 'happy';

DROP TABLE person;
DROP TYPE mood;

CREATE DOMAIN us_postal_code AS TEXT
CHECK (VALUE ~ '^\d{5}(-\d{4})?$');

CREATE TABLE address (
    address_id SERIAL PRIMARY KEY,
    street TEXT NOT NULL,
    city TEXT NOT NULL,
    postal_code us_postal_code NOT NULL
);

INSERT INTO address (street, city, postal_code) VALUES
('123 Main St', 'Anytown', '12345');

SELECT * FROM address;

DROP TABLE address;
DROP DOMAIN us_postal_code;

CREATE TABLE products (
    product_no integer,
    name text,
    price numeric
);

INSERT INTO products VALUES
(1, 'Cheese', 9.99),
(2, 'Bread', 1.99),
(3, 'Milk', 2.99);

CREATE OR REPLACE FUNCTION discount(price numeric, discount numeric)
RETURNS numeric AS $$
BEGIN
    RETURN price * (1 - discount);
END;
$$ LANGUAGE plpgsql;

SELECT name, discount(price, 0.1) FROM products;

DROP FUNCTION discount(numeric, numeric);
DROP TABLE products;

DROP TABLE test_table;