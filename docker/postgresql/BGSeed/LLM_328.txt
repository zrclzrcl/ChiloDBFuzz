CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    price DECIMAL(10, 2)
);

CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    order_date TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    total_amount DECIMAL(10, 2)
);

CREATE TABLE order_items (
    order_item_id SERIAL PRIMARY KEY,
    order_id INTEGER REFERENCES orders(order_id),
    product_id INTEGER REFERENCES products(product_id),
    quantity INTEGER,
    price DECIMAL(10, 2)
);

INSERT INTO users (username, email) VALUES ('john_doe', 'john.doe@example.com');
INSERT INTO users (username, email) VALUES ('jane_smith', 'jane.smith@example.com');

INSERT INTO products (name, description, price) VALUES ('Laptop', 'Powerful laptop for work and gaming', 1200.00);
INSERT INTO products (name, description, price) VALUES ('Mouse', 'Ergonomic wireless mouse', 25.00);
INSERT INTO products (name, description, price) VALUES ('Keyboard', 'Mechanical keyboard', 75.00);

INSERT INTO orders (user_id, total_amount) VALUES (1, 1300.00);
INSERT INTO orders (user_id, total_amount) VALUES (2, 100.00);

INSERT INTO order_items (order_id, product_id, quantity, price) VALUES (1, 1, 1, 1200.00);
INSERT INTO order_items (order_id, product_id, quantity, price) VALUES (1, 2, 2, 25.00);
INSERT INTO order_items (order_id, product_id, quantity, price) VALUES (2, 3, 1, 75.00);
INSERT INTO order_items (order_id, product_id, quantity, price) VALUES (2, 2, 1, 25.00);

SELECT * FROM users;
SELECT * FROM products;
SELECT * FROM orders;
SELECT * FROM order_items;

UPDATE products SET price = 1250.00 WHERE product_id = 1;

DELETE FROM order_items WHERE order_item_id = 4;

SELECT u.username, o.order_date, o.total_amount
FROM users u
JOIN orders o ON u.id = o.user_id;

CREATE INDEX CONCURRENTLY idx_username ON users (username);

CREATE TABLE data (
  id SERIAL PRIMARY KEY,
  payload JSONB
);

INSERT INTO data (payload) VALUES ('{"key1": "value1", "key2": 123}');
INSERT INTO data (payload) VALUES ('{"key3": "value3", "key4": true}');

SELECT payload -> 'key1' FROM data WHERE id = 1;

SELECT * FROM generate_series(1, 10);

DROP INDEX idx_username;
DROP TABLE order_items;
DROP TABLE orders;
DROP TABLE products;
DROP TABLE users;
DROP TABLE data;