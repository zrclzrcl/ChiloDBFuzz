CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    department VARCHAR(100),
    salary DECIMAL(10, 2)
);

CREATE TABLE departments (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    location VARCHAR(100)
);

INSERT INTO departments (name, location) VALUES
('Sales', 'New York'),
('Marketing', 'Los Angeles'),
('Engineering', 'San Francisco');

INSERT INTO employees (name, department, salary) VALUES
('Alice Smith', 'Sales', 60000.00),
('Bob Johnson', 'Marketing', 75000.00),
('Charlie Brown', 'Engineering', 90000.00),
('David Lee', 'Sales', 65000.00),
('Eve Wilson', 'Marketing', 80000.00);

SELECT name, department,
       CASE
           WHEN salary > 80000 THEN 'High'
           WHEN salary > 65000 THEN 'Medium'
           ELSE 'Low'
       END AS salary_level
FROM employees;

SELECT e.name, d.location,
       CASE
           WHEN d.location = 'New York' THEN 'East Coast'
           WHEN d.location = 'Los Angeles' THEN 'West Coast'
           ELSE 'Other'
       END AS region
FROM employees e
JOIN departments d ON e.department = d.name;

SELECT id, name,
       CASE department
           WHEN 'Sales' THEN salary * 1.10
           WHEN 'Marketing' THEN salary * 1.15
           ELSE salary
       END AS adjusted_salary
FROM employees;

SELECT
    CASE
        WHEN (SELECT COUNT(*) FROM employees) > 3 THEN 'Many employees'
        ELSE 'Few employees'
    END AS employee_count_status;

SELECT name, department, salary,
       CASE
           WHEN salary > (SELECT AVG(salary) FROM employees) THEN 'Above Average'
           ELSE 'Below Average'
       END AS salary_comparison
FROM employees;

SELECT
    COALESCE(NULLIF(name, 'Alice Smith'), 'Unknown') AS employee_name
FROM employees
WHERE id = 1;

SELECT
    CASE WHEN EXISTS (SELECT 1 FROM employees WHERE salary > 100000) THEN 'High earners exist' ELSE 'No high earners' END;

SELECT
    CASE
        WHEN 1 = 1 THEN CAST('2024-01-01' AS DATE)
        ELSE NULL
    END;

SELECT
    CASE
        WHEN (SELECT 1) IS NOT NULL THEN 'Subquery returned something'
        ELSE 'Subquery returned NULL'
    END;

SELECT id, name,
    CASE
        WHEN salary > 70000 THEN 'High Salary'
        WHEN salary BETWEEN 60000 AND 70000 THEN 'Mid Salary'
        ELSE 'Low Salary'
    END AS salary_range
FROM employees;

SELECT department,
       CASE
           WHEN AVG(salary) > 70000 THEN 'High Average'
           ELSE 'Low Average'
       END AS avg_salary_status
FROM employees
GROUP BY department;

SELECT id, name,
    CASE
        WHEN salary > (SELECT MAX(salary) FROM employees) * 0.8 THEN 'Top 20%'
        ELSE 'Other'
    END AS top_earner
FROM employees;

DROP TABLE employees;
DROP TABLE departments;