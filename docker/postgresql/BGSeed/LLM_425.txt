CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255),
    salary DECIMAL,
    hire_date DATE
);

CREATE INDEX idx_employees_salary ON employees (salary);

INSERT INTO employees (name, salary, hire_date) VALUES
('Alice', 60000, '2022-01-15'),
('Bob', 75000, '2021-05-20'),
('Charlie', 90000, '2023-03-10');

SELECT * FROM employees WHERE salary > 70000;

UPDATE employees SET salary = salary * 1.1 WHERE id = 1;

DELETE FROM employees WHERE hire_date < '2022-01-01';

SELECT AVG(salary) FROM employees;

SELECT COUNT(*) FROM employees;

SELECT name, MAX(salary) FROM employees GROUP BY name;

SELECT hire_date, SUM(salary) FROM employees GROUP BY hire_date ORDER BY hire_date;

CREATE VIEW high_earners AS
SELECT name, salary FROM employees WHERE salary > 80000;

SELECT * FROM high_earners;

DROP VIEW high_earners;

ALTER TABLE employees ADD COLUMN department VARCHAR(255);

UPDATE employees SET department = 'Sales' WHERE id IN (1, 2);
UPDATE employees SET department = 'Marketing' WHERE id = 3;

SELECT department, COUNT(*) FROM employees GROUP BY department;

SELECT e1.name AS employee_name, e2.name AS manager_name
FROM employees e1
LEFT JOIN employees e2 ON e1.id = e2.id;

SELECT generate_series(1, 10);

SELECT pg_backend_pid();

SELECT inet_client_addr();

CREATE FUNCTION increment(i integer) RETURNS integer AS $$
        BEGIN
                RETURN i + 1;
        END;
$$ LANGUAGE plpgsql;

SELECT increment(5);

DROP FUNCTION increment(integer);

CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255),
    price DECIMAL
);

INSERT INTO products (name, price) VALUES ('Laptop', 1200.00), ('Mouse', 25.00);

SELECT * FROM products WHERE price BETWEEN 20 AND 1300;

SELECT name, price FROM products ORDER BY price DESC;

SELECT upper(name) FROM products;

SELECT lower(name) FROM products;

SELECT substring(name, 1, 3) FROM products;

SELECT md5(name) FROM products;

SELECT current_timestamp;

SELECT date_trunc('month', hire_date) FROM employees;

SELECT age(hire_date) FROM employees;

SELECT to_char(hire_date, 'YYYY-MM-DD') FROM employees;

SELECT id, name, salary FROM employees WHERE name LIKE 'A%';

SELECT id, name, salary FROM employees WHERE name ILIKE 'a%';

SELECT * FROM employees WHERE salary IS NULL;

SELECT * FROM employees WHERE salary IS NOT NULL;

SELECT coalesce(department, 'Unknown') FROM employees;

SELECT nullif(10, 10);

SELECT greatest(10, 5, 20);

SELECT least(10, 5, 20);

CREATE TYPE mood AS ENUM ('sad', 'ok', 'happy');

CREATE TABLE person (
    name TEXT,
    current_mood mood
);

INSERT INTO person VALUES ('Moe', 'happy');

SELECT * FROM person WHERE current_mood = 'happy';

DROP TABLE person;
DROP TYPE mood;

SELECT version();

SHOW server_version;

SHOW data_directory;

SELECT inet_server_addr();

SELECT inet_server_port();

SELECT pg_conf_load_time();

SELECT pg_current_logfile();

SELECT pg_is_in_recovery();

SELECT pg_read_binary_file('README', 0, 100, true);

SELECT pg_tablespace_location(oid) from pg_tablespace where spcname = 'pg_default';

CREATE TABLESPACE my_tablespace LOCATION '/tmp/my_tablespace';
DROP TABLESPACE my_tablespace;

CREATE EXTENSION IF NOT EXISTS ltree;
DROP EXTENSION ltree;