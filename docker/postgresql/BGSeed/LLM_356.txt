CREATE TABLE employee (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    department VARCHAR(50),
    salary DECIMAL(10, 2)
);

INSERT INTO employee (name, department, salary) VALUES
('Alice Smith', 'Sales', 60000.00),
('Bob Johnson', 'Marketing', 75000.00),
('Charlie Brown', 'Engineering', 90000.00);

CREATE INDEX idx_employee_department ON employee (department);

SELECT * FROM employee WHERE department = 'Sales';

UPDATE employee SET salary = salary * 1.1 WHERE department = 'Engineering';

DELETE FROM employee WHERE id = 3;

SELECT AVG(salary) FROM employee;

ALTER TABLE employee ADD COLUMN hire_date DATE;

UPDATE employee SET hire_date = CURRENT_DATE - INTERVAL '1 year' WHERE id = 1;
UPDATE employee SET hire_date = CURRENT_DATE - INTERVAL '6 months' WHERE id = 2;

SELECT name, EXTRACT(YEAR FROM hire_date) AS hire_year FROM employee;

CREATE VIEW high_earners AS
SELECT name, salary FROM employee WHERE salary > 70000;

SELECT * FROM high_earners;

CREATE FUNCTION increment_salary(emp_id INTEGER, increment DECIMAL)
RETURNS VOID AS $$
BEGIN
    UPDATE employee SET salary = salary + increment WHERE id = emp_id;
END;
$$ LANGUAGE plpgsql;

SELECT increment_salary(1, 5000);

SELECT * FROM employee WHERE id = 1;

DROP FUNCTION increment_salary(INTEGER, DECIMAL);

DROP VIEW high_earners;

DROP INDEX idx_employee_department;

DROP TABLE employee;

CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    product_name VARCHAR(100) NOT NULL,
    price DECIMAL(10, 2)
);

INSERT INTO products (product_name, price) VALUES
('Laptop', 1200.00),
('Mouse', 25.00),
('Keyboard', 75.00);

CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    product_id INTEGER REFERENCES products(product_id),
    quantity INTEGER
);

INSERT INTO orders (product_id, quantity) VALUES
(1, 2),
(2, 10),
(3, 5);

SELECT p.product_name, SUM(o.quantity) AS total_quantity
FROM products p JOIN orders o ON p.product_id = o.product_id
GROUP BY p.product_name;

CREATE MATERIALIZED VIEW product_summary AS
SELECT p.product_name, AVG(o.quantity) AS avg_quantity
FROM products p JOIN orders o ON p.product_id = o.product_id
GROUP BY p.product_name;

REFRESH MATERIALIZED VIEW product_summary;

SELECT * FROM product_summary;

DROP MATERIALIZED VIEW product_summary;

DROP TABLE orders;

DROP TABLE products;

CREATE TABLE logs (
    log_id SERIAL PRIMARY KEY,
    log_time TIMESTAMP WITH TIME ZONE DEFAULT now(),
    message TEXT
);

INSERT INTO logs (message) VALUES
('System started'),
('User logged in'),
('Data processed');

SELECT * FROM logs WHERE log_time BETWEEN now() - INTERVAL '1 day' AND now();

TRUNCATE TABLE logs;

DROP TABLE logs;

CREATE UNLOGGED TABLE temp_data (
    id SERIAL PRIMARY KEY,
    value TEXT
);

INSERT INTO temp_data (value) VALUES ('temporary value');

SELECT * FROM temp_data;

DROP TABLE temp_data;

CREATE TABLE parent (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50)
);

CREATE TABLE child (
    id SERIAL PRIMARY KEY,
    parent_id INTEGER REFERENCES parent(id) ON DELETE CASCADE,
    value VARCHAR(50)
);

INSERT INTO parent (name) VALUES ('Parent 1');
INSERT INTO child (parent_id, value) VALUES (1, 'Child 1');

DELETE FROM parent WHERE id = 1;

DROP TABLE child;
DROP TABLE parent;