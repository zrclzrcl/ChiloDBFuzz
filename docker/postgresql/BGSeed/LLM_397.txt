CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    department VARCHAR(255),
    salary DECIMAL(10, 2),
    hire_date DATE
);

CREATE TABLE departments (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    location VARCHAR(255)
);

CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    price DECIMAL(10, 2),
    category VARCHAR(255),
    attributes JSONB
);

INSERT INTO departments (name, location) VALUES
('Sales', 'New York'),
('Marketing', 'Los Angeles'),
('Engineering', 'San Francisco');

INSERT INTO employees (name, department, salary, hire_date) VALUES
('Alice Smith', 'Sales', 60000.00, '2022-01-15'),
('Bob Johnson', 'Marketing', 75000.00, '2021-05-20'),
('Charlie Brown', 'Engineering', 90000.00, '2023-03-10');

INSERT INTO products (name, description, price, category, attributes) VALUES
('Laptop', 'High-performance laptop', 1200.00, 'Electronics', '{"brand": "Dell", "memory": "16GB"}'),
('Office Chair', 'Ergonomic office chair', 250.00, 'Furniture', '{"color": "Black", "material": "Mesh"}');

SELECT * FROM employees WHERE salary > 70000;

SELECT name, salary FROM employees ORDER BY salary DESC;

SELECT department, AVG(salary) FROM employees GROUP BY department;

UPDATE employees SET salary = salary * 1.10 WHERE department = 'Engineering';

DELETE FROM products WHERE price < 200;

SELECT e.name, d.location FROM employees e JOIN departments d ON e.department = d.name;

WITH high_earners AS (
    SELECT name, salary FROM employees WHERE salary > 80000
)
SELECT * FROM high_earners;

SELECT jsonb_pretty(attributes) FROM products;

SELECT UNNEST(ARRAY['apple', 'banana', 'cherry']);

SELECT generate_series(1, 10);

SELECT pg_sleep(0.1);

CREATE TABLE test_table (
    id INT,
    data TEXT
);

INSERT INTO test_table (id, data) VALUES (1, 'test data');

SELECT * FROM test_table;

DROP TABLE test_table;

CREATE OR REPLACE FUNCTION add_one(i INTEGER)
RETURNS INTEGER AS $$
        BEGIN
                RETURN i + 1;
        END;
$$ LANGUAGE plpgsql;

SELECT add_one(5);

DROP FUNCTION add_one(INTEGER);

CREATE TABLE range_test (
    tsrange TSRANGE,
    int4range INT4RANGE
);

INSERT INTO range_test (tsrange, int4range) VALUES (
    '[2010-01-01 14:30, 2010-01-01 15:30)'::tsrange,
    '[10,20]'::int4range
);

SELECT * from range_test;

DROP TABLE range_test;

CREATE TABLE interval_test (
    intrvl INTERVAL
);

INSERT INTO interval_test (intrvl) VALUES ('1 year 2 months 3 days 4 hours 5 minutes 6 seconds');

SELECT * from interval_test;

DROP TABLE interval_test;