import{h as D,_ as z,r as d,i as S,j as R,o as B,c as p,f as u,d as s,k as C,l as V,t as g,F as j,e as F,m as E,g as M,u as G,p as W}from"./index-DKzMqUOh.js";/**
 * @license lucide-vue-next v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=D("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Y={class:"idx"},q={class:"val"},A={__name:"BitGrid",props:{data:{type:Array,default:()=>[]},type:{type:String,default:"bool"},cellSize:{type:Number,default:4},gap:{type:Number,default:1}},setup(w){const t=w,n=d(null),l=d(null),a=d(null),h=S(()=>{if(!n.value)return 64;const e=n.value.clientWidth;return Math.floor(e/(t.cellSize+t.gap))});function v(){var k;const e=(k=l.value)==null?void 0:k.getContext("2d");if(!e||!t.data.length)return;const o=n.value.clientWidth,_=t.data.length,m=h.value,b=Math.ceil(_/m),r=t.cellSize,y=t.gap;l.value.width=o,l.value.height=b*(r+y),e.clearRect(0,0,l.value.width,l.value.height);for(let c=0;c<_;c++){const x=t.data[c];if(x===0&&t.type==="bool")continue;const $=c%m,I=Math.floor(c/m),L=$*(r+y),N=I*(r+y);e.fillStyle=f(x),e.fillRect(L,N,r,r)}}function f(e){if(t.type==="bool")return e>0?"#00f0ff":"#1e293b";{if(e===0)return"#1e293b";const o=Math.min(1,Math.log2(e+1)/8);return`hsl(${200+o*120}, 100%, ${30+o*40}%)`}}function i(e){const o=l.value.getBoundingClientRect(),_=e.clientX-o.left,m=e.clientY-o.top,b=t.cellSize+t.gap,r=h.value,y=Math.floor(_/b),c=Math.floor(m/b)*r+y;c>=0&&c<t.data.length?a.value={x:e.clientX+10,y:e.clientY+10,index:c,value:t.data[c]}:a.value=null}return R(()=>t.data,v,{deep:!0}),B(()=>{window.addEventListener("resize",v),v()}),(e,o)=>(u(),p("div",{class:"bit-grid-container",ref_key:"container",ref:n},[s("canvas",{ref_key:"canvas",ref:l,onMousemove:i,onMouseleave:o[0]||(o[0]=_=>a.value=null)},null,544),a.value?(u(),p("div",{key:0,class:"grid-tooltip",style:V({top:a.value.y+"px",left:a.value.x+"px"})},[s("div",Y,"Index: "+g(a.value.index),1),s("div",q,"Value: "+g(a.value.value),1)],4)):C("",!0)],512))}},H=z(A,[["__scopeId","data-v-a7b2cb49"]]),T={class:"page-bitmap"},U={class:"page-header"},J={class:"title-group"},K={key:0,class:"subtitle"},O={class:"controls"},P={class:"btn-group"},Q=["onClick"],Z=["disabled"],ee={class:"content-area"},te={class:"card grid-card"},ae={key:1,class:"empty-state"},se={__name:"Bitmap",setup(w){const t=d("sum"),n=d(!1),l=d({sum:[],cumulative:[],bool:[]}),a=d({mapSize:0}),h=S(()=>l.value[t.value]||[]);async function v(){n.value=!0;try{const i=await(await fetch("/api/bitmap/frame")).json();i.ok&&(l.value=i.channels,a.value={mapSize:i.mapSize})}catch(f){console.error("Fetch bitmap failed",f)}finally{n.value=!1}}return B(v),(f,i)=>(u(),p("div",T,[s("header",U,[s("div",J,[i[0]||(i[0]=s("h1",null,"Bitmap 热力图",-1)),a.value.mapSize?(u(),p("span",K,"Size: "+g(a.value.mapSize)+" bits",1)):C("",!0)]),s("div",O,[s("div",P,[(u(),p(j,null,F(["sum","cumulative","bool"],e=>s("button",{key:e,class:M({active:t.value===e}),onClick:o=>t.value=e},g(e.toUpperCase()),11,Q)),64))]),s("button",{class:"btn-refresh",onClick:v,disabled:n.value},[E(G(X),{class:M({spinning:n.value})},null,8,["class"])],8,Z)])]),s("div",ee,[s("div",te,[h.value.length?(u(),W(H,{key:0,data:h.value,type:t.value==="bool"?"bool":"heat"},null,8,["data","type"])):(u(),p("div",ae,g(n.value?"加载中...":"暂无数据"),1))])])]))}},ne=z(se,[["__scopeId","data-v-210307c7"]]);export{ne as default};
