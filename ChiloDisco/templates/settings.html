<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChiloDisco ¬∑ Á≥ªÁªüËÆæÁΩÆ</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Outfit:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="/static/css/styles.css" />
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="/static/js/toast.js"></script>
  <style>
    .settings-container {
      max-width: 800px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .settings-section {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      border: 1px solid var(--glass-border);
    }

    .setting-info h4 {
      margin: 0 0 4px 0;
      color: var(--text-primary);
    }

    .setting-info p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* Switch Component */
    .switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 26px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--bg-secondary);
      transition: .4s;
      border-radius: 34px;
      border: 1px solid var(--glass-border);
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: var(--text-secondary);
      transition: .4s;
      border-radius: 50%;
    }

    input:checked+.slider {
      background-color: var(--accent-primary);
      border-color: var(--accent-primary);
    }

    input:checked+.slider:before {
      transform: translateX(22px);
      background-color: #fff;
    }

    input:disabled+.slider {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .kbd {
      background: rgba(0, 0, 0, 0.3);
      padding: 4px 8px;
      border-radius: 4px;
      border: 1px solid var(--glass-border);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      margin-right: 0.5rem;
    }
  </style>
</head>

<body>
  <div id="app" class="app-layout">
    <aside class="sidebar">
      <div class="brand">
        <span class="brand-icon">‚ö°</span>
        <span>ChiloDisco</span>
      </div>
      <nav class="nav-menu">
        <a href="/" class="nav-item"><span>üìä Êó•ÂøóÁõëÊéß</span></a>
        <a href="/plot" class="nav-item"><span>üìà Êï∞ÊçÆÂ§ßÂ±è</span></a>
        <a href="/bitmap" class="nav-item"><span>üó∫Ô∏è Bitmap ÁÉ≠ÂäõÂõæ</span></a>
        <a href="/downloads" class="nav-item"><span>üíæ ÁªìÊûú‰∏ãËΩΩ</span></a>
        <a href="/settings" class="nav-item active"><span>‚öôÔ∏è Á≥ªÁªüËÆæÁΩÆ</span></a>
      </nav>
    </aside>

    <main class="main-content">
      <div class="content-scrollable">
        <div class="settings-container">

          <header>
            <h2>Configuration</h2>
            <p class="text-muted">Customize your ChiloDisco experience.</p>
          </header>

          <section class="glass-panel" style="padding: 1.5rem;">
            <h3 class="mb-4">üé® Visual Effects</h3>
            <div class="settings-section">

              <div class="setting-item">
                <div class="setting-info">
                  <h4>Performance Mode</h4>
                  <p>Disable all animations for better performance.</p>
                </div>
                <label class="switch">
                  <input type="checkbox" v-model="performanceMode">
                  <span class="slider"></span>
                </label>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <h4>Particle Effects</h4>
                  <p>Enable background particle animation.</p>
                </div>
                <label class="switch">
                  <input type="checkbox" v-model="particlesEnabled" :disabled="performanceMode">
                  <span class="slider"></span>
                </label>
              </div>

              <div class="setting-item">
                <div class="setting-info">
                  <h4>Glass Glow</h4>
                  <p>Enable neon glow on borders.</p>
                </div>
                <label class="switch">
                  <input type="checkbox" v-model="glowEnabled" :disabled="performanceMode">
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </section>

          <section class="glass-panel" style="padding: 1.5rem;">
            <h3 class="mb-4">‚ö° Diagnostics</h3>
            <div class="flex-row gap-4">
              <div class="glass-panel" style="padding: 1rem; flex: 1; text-align: center;">
                <div class="text-muted text-sm uppercase">FPS</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-success);">{{ fps }}</div>
              </div>
              <div class="glass-panel" style="padding: 1rem; flex: 1; text-align: center;">
                <div class="text-muted text-sm uppercase">Memory</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-primary);">{{ memoryUsage }}</div>
              </div>
            </div>
          </section>

          <section class="glass-panel" style="padding: 1.5rem;">
            <h3 class="mb-4">üíæ Data Management</h3>
            <div class="flex-row gap-2 flex-wrap">
              <button class="btn btn-glass" @click="clearCache">Trash Cache</button>
              <button class="btn btn-glass" @click="resetSettings">Reset Default</button>
              <button class="btn btn-primary" @click="exportSettings">Export Config</button>
              <button class="btn btn-primary" @click="importSettings">Import Config</button>
            </div>
          </section>

          <section class="glass-panel" style="padding: 1.5rem;">
            <h3 class="mb-4">‚å®Ô∏è Shortcuts</h3>
            <div class="setting-item">
              <div><span class="kbd">Space</span> Pause/Resume</div>
            </div>
            <div class="setting-item">
              <div><span class="kbd">Ctrl</span>+<span class="kbd">F</span> Search</div>
            </div>
            <!-- Add more as needed -->
          </section>

        </div>
      </div>
    </main>
  </div>

  <script>
    const { createApp, ref, watch, onMounted, computed } = Vue;

    createApp({
      setup() {
        const performanceMode = ref(localStorage.getItem('cd_performanceMode') === 'true');
        const particlesEnabled = ref(localStorage.getItem('cd_particles') !== 'false');
        const glowEnabled = ref(localStorage.getItem('cd_glow') !== 'false');

        const fps = ref(60);
        const memoryUsage = ref('N/A');

        watch(performanceMode, (val) => {
          localStorage.setItem('cd_performanceMode', val);
          if (val) { particlesEnabled.value = false; glowEnabled.value = false; }
          else { particlesEnabled.value = true; glowEnabled.value = true; }
        });

        watch([particlesEnabled, glowEnabled], ([p, g]) => {
          localStorage.setItem('cd_particles', p);
          localStorage.setItem('cd_glow', g);
        });

        // Diagnostics
        let lastTime = performance.now();
        let frames = 0;
        function loop() {
          frames++;
          const now = performance.now();
          if (now >= lastTime + 1000) {
            fps.value = frames;
            frames = 0;
            lastTime = now;
            if (performance.memory) {
              memoryUsage.value = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + ' MB';
            }
          }
          requestAnimationFrame(loop);
        }

        onMounted(() => {
          loop();
        });

        function clearCache() { sessionStorage.clear(); alert('Cache cleared'); }
        function resetSettings() { localStorage.clear(); location.reload(); }
        function exportSettings() {
          const data = JSON.stringify({ performanceMode: performanceMode.value });
          const blob = new Blob([data], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = 'config.json'; a.click();
        }
        function importSettings() { alert('Not implemented in demo'); }

        return {
          performanceMode, particlesEnabled, glowEnabled,
          fps, memoryUsage,
          clearCache, resetSettings, exportSettings, importSettings
        };
      }
    }).mount('#app');
  </script>
</body>

</html>